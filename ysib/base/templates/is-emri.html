{% extends "base.html" %}
{% load static %}
{% block style %}
<link href="{% static 'css/bootstrap-tables.css' %}" rel="stylesheet">
<link href="{% static 'css/skeyboard.css' %}" rel="stylesheet">
<style>
    
.simple-keyboard {
  /*max-width: 850px;*/
    position:fixed;
    bottom:0px;
    left:0px;
    right:0px;
    margin-bottom:0px;
    width: 100%;
    opacity: 0;
    transition: margin-top 0s ease-in-out 0.3s, opacity 0.3s ease-in-out;
    z-index:9999;
    height: 230px;
    display: none;
}

.show-keyboard {
  display : block;
  opacity: 1;
  margin-top: 0;
}

.hg-button span {
  pointer-events: none;
}

</style>
{% endblock %}
{% block content %}
<div class="card">
  <div class="card-header"  style="color: #c7ae3c;background-color: #2f4050; font-size: 20px;">
    İş emri oluşturma
  </div>
  <div class="card-body">
    <form>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="isemri">İş Emri</label>
          <input type="text" class="form-control input" id="isemri">
        </div>
        <div class="form-group col-md-6">
          <label for="baslangis">Başlangıç</label>
          <input type="text" class="form-control input" id="baslangis">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="bitis">Bitiş</label>
          <input type="text" class="form-control input" id="bitis">
        </div>
        <div class="form-group col-md-6">
          <label for="tupsayisi">Tüp Sayısı</label>
          <input type="text" class="form-control input" id="tupsayisi">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="kullanici">Kullanıcı(Emri Veren)</label>
          <input type="text" class="form-control input" id="kullanici">
        </div>
        </div>
     
      <button type="submit" class="btn btn-primary float-right">Emir Oluştur</button>
    </form>
  </div>
</div>




<div class="card mt-4">
  <div class="card-header" style="color: #c7ae3c;background-color: #2f4050; font-size: 20px;">
    İş emri tablosu 
  </div>
  <div class="card-body">
    <div id="toolbar">
    </div>
    
    <table id="table" 
         data-toggle="table"
         data-search="true"
         data-filter-control="true" 
         data-toolbar="#toolbar">
    <thead>
      <tr>
        <th data-field="isemri" data-filter-control="select" data-sortable="true">İş Emri</th>
        <th data-field="tarih" data-filter-control="select" data-sortable="true">Tarih</th>
        <th data-field="kullanici" data-filter-control="select" data-sortable="true">Kullanıcı</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        
        <td>İş emri 1</td>
        <td>22/05/2020</td>
        <td>Ali</td>
      </tr>
      <tr>
        <td>İs Emri 2</td>
        <td>23/04/2020</td>
        <td>Veli</td>
      </tr>
      <tr>
        <td>İs Emri 2</td>
        <td>13/03/2020</td>
        <td>Ahmet</td>
      </tr>
      
    </tbody>
    </table>
    </div>
  </div>



{% endblock %}
{% block script %}
<script src="{% static 'js/bootstrap-tables.js' %}"></script>
<script src="{% static 'js/skeyboard.js' %}"></script>
<script>

let Keyboard = window.SimpleKeyboard.default;
let selectedInput;

let keyboard = new Keyboard({
  onChange: input => onChange(input),
  onKeyPress: button => onKeyPress(button)
});

document.querySelectorAll(".input").forEach(input => {
  input.addEventListener("focus", onInputFocus);
  // Optional: Use if you want to track input changes
  // made without simple-keyboard
  input.addEventListener("input", onInputChange);
});


var els = document.querySelectorAll(".input");
for (let i = 0; i < els.length; i++) {
  const element = els[i];
  element.addEventListener("focus", event => {
    //keyboard.keyboardDOM.style.top = window.scrollY + screen.availHeight - 330 + "px";
    keyboard.keyboardDOM.classList.add("show-keyboard");
  });
}



document.addEventListener("click", event => {
  if (
    // Target is not keyboard element
    event.target !== keyboard.keyboardDOM &&
    // Target is not the input
    !event.target.classList.contains('input') &&
    // Target is not a keyboard button
    !event.target.classList.contains("hg-button")
  ) {
    hideKeyboard();
  }
});





function onInputFocus(event) {
  selectedInput = `#${event.target.id}`;

  keyboard.setOptions({
    inputName: event.target.id
  });
}

function onInputChange(event) {
  keyboard.setInput(event.target.value, event.target.id);
}

function onChange(input) {
  console.log("Input changed", input);
  document.querySelector(selectedInput || ".input").value = input;
}

function onKeyPress(button) {
  console.log("Button pressed", button);

  /**
   * Shift functionality
   */
  if (button === "{lock}" || button === "{shift}") handleShiftButton();
}

function handleShiftButton() {
  let currentLayout = keyboard.options.layoutName;
  let shiftToggle = currentLayout === "default" ? "shift" : "default";

  keyboard.setOptions({
    layoutName: shiftToggle
  });
}




function showKeyboard() {
  keyboard.keyboardDOM.classList.add("show-keyboard");
}

function hideKeyboard() {
  keyboard.keyboardDOM.classList.remove("show-keyboard");
}

</script>

{% endblock %}
